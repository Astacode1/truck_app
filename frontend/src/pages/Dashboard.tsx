export default function Dashboard() {export default function Dashboard() {export default function Dashboard() {export default function Dashboard() {

  return (

    <div className="min-h-screen bg-gray-50 p-6">  return (

      <div className="mx-auto max-w-7xl">

        <h1 className="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>    <div className="min-h-screen bg-gray-50 p-6">  return (  return (

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">

          <div className="bg-white p-6 rounded-lg shadow">      <div className="mx-auto max-w-7xl">

            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Trips</h3>

            <p className="text-3xl font-bold text-blue-600">42</p>        <h1 className="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>    <div className="min-h-screen bg-gray-50 p-6">    <div className="min-h-screen bg-gray-50 p-6">

          </div>

          <div className="bg-white p-6 rounded-lg shadow">        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">

            <h3 className="text-lg font-semibold text-gray-900 mb-2">Active Trucks</h3>

            <p className="text-3xl font-bold text-green-600">8</p>          <div className="bg-white p-6 rounded-lg shadow">      <div className="mx-auto max-w-7xl">      <div className="mx-auto max-w-7xl">

          </div>

          <div className="bg-white p-6 rounded-lg shadow">            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Trips</h3>

            <h3 className="text-lg font-semibent text-gray-900 mb-2">Total Revenue</h3>

            <p className="text-3xl font-bold text-purple-600">$12,450</p>            <p className="text-3xl font-bold text-blue-600">42</p>        <h1 className="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>        <h1 className="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>

          </div>

          <div className="bg-white p-6 rounded-lg shadow">          </div>

            <h3 className="text-lg font-semibold text-gray-900 mb-2">Fuel Costs</h3>

            <p className="text-3xl font-bold text-red-600">$3,200</p>          <div className="bg-white p-6 rounded-lg shadow">        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">

          </div>

        </div>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Active Trucks</h3>

        <div className="bg-white p-6 rounded-lg shadow">

          <h2 className="text-xl font-semibold text-gray-900 mb-4">Recent Activity</h2>            <p className="text-3xl font-bold text-green-600">8</p>          <div className="bg-white p-6 rounded-lg shadow">          <div className="bg-white p-6 rounded-lg shadow">

          <p className="text-gray-600">Dashboard loaded successfully!</p>

        </div>          </div>

      </div>

    </div>          <div className="bg-white p-6 rounded-lg shadow">            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Trips</h3>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Trips</h3>

  );

}            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Revenue</h3>

            <p className="text-3xl font-bold text-purple-600">$12,450</p>            <p className="text-3xl font-bold text-blue-600">42</p>            <p className="text-3xl font-bold text-blue-600">42</p>

          </div>

          <div className="bg-white p-6 rounded-lg shadow">          </div>          </div>

            <h3 className="text-lg font-semibold text-gray-900 mb-2">Fuel Costs</h3>

            <p className="text-3xl font-bold text-red-600">$3,200</p>          <div className="bg-white p-6 rounded-lg shadow">          <div className="bg-white p-6 rounded-lg shadow">

          </div>

        </div>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Active Trucks</h3>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Active Trucks</h3>

        <div className="bg-white p-6 rounded-lg shadow">

          <h2 className="text-xl font-semibold text-gray-900 mb-4">Recent Activity</h2>            <p className="text-3xl font-bold text-green-600">8</p>            <p className="text-3xl font-bold text-green-600">8</p>

          <p className="text-gray-600">Dashboard is loading...</p>

        </div>          </div>          </div>

      </div>

    </div>          <div className="bg-white p-6 rounded-lg shadow">          <div className="bg-white p-6 rounded-lg shadow">

  );

}            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Revenue</h3>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Total Revenue</h3>

            <p className="text-3xl font-bold text-purple-600">$12,450</p>            <p className="text-3xl font-bold text-purple-600">$12,450</p>

          </div>          </div>

          <div className="bg-white p-6 rounded-lg shadow">          <div className="bg-white p-6 rounded-lg shadow">

            <h3 className="text-lg font-semibold text-gray-900 mb-2">Fuel Costs</h3>            <h3 className="text-lg font-semibold text-gray-900 mb-2">Fuel Costs</h3>

            <p className="text-3xl font-bold text-red-600">$3,200</p>            <p className="text-3xl font-bold text-red-600">$3,200</p>

          </div>          </div>

        </div>        </div>

        <div className="bg-white p-6 rounded-lg shadow">        <div className="bg-white p-6 rounded-lg shadow">

          <h2 className="text-xl font-semibold text-gray-900 mb-4">Recent Activity</h2>          <h2 className="text-xl font-semibold text-gray-900 mb-4">Recent Activity</h2>

          <p className="text-gray-600">Dashboard is loading...</p>          <p className="text-gray-600">Dashboard is loading...</p>

        </div>        </div>

      </div>      </div>

    </div>    </div>

  );  );

}}
          overview: {
            overview: {
              thisMonth: { totalAmount: 25420, totalCount: 156, growth: 12 },
              pending: { receipts: 23 },
              fleet: { totalTrucks: 24, activeTrucks: 18, utilizationRate: 75 },
              drivers: { total: 32 }
            }
          },
          summary: {
            summary: {
              totalAmount: 25420,
              totalReceipts: 156,
              pendingReceipts: 23,
              approvedReceipts: 133,
              rejectedReceipts: 8,
              averageExpense: 163
            },
            expenses: [
              { groupBy: 'Fuel', totalAmount: 12500, receiptCount: 87, percentage: 49, averageAmount: 143.68 },
              { groupBy: 'Maintenance', totalAmount: 8200, receiptCount: 34, percentage: 32, averageAmount: 241.18 },
              { groupBy: 'Tolls', totalAmount: 3100, receiptCount: 28, percentage: 12, averageAmount: 110.71 },
              { groupBy: 'Food', totalAmount: 1620, receiptCount: 7, percentage: 7, averageAmount: 231.43 }
            ]
          }
        });
      } finally {
        setLoading(false);
      }
    };

    fetchData();
  }, [dateRange.start, dateRange.end, groupBy]);

  // Export handlers
  const handleExportCSV = () => {
    const url = `http://localhost:3001/api/reports/export/csv?start=${dateRange.start}&end=${dateRange.end}&groupBy=${groupBy}`;
    window.open(url, '_blank');
  };

  const handleExportPDF = () => {
    const url = `http://localhost:3001/api/reports/export/pdf?start=${dateRange.start}&end=${dateRange.end}&groupBy=${groupBy}`;
    window.open(url, '_blank');
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center h-64">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
          <p className="mt-4 text-gray-600">Loading dashboard...</p>
        </div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Header */}
      <div>
        <h1 className="text-3xl font-bold text-gray-900">Admin Dashboard</h1>
        <p className="text-gray-600">Comprehensive overview of fleet expenses and operations</p>
      </div>

      {/* Stats Cards */}
      {data?.overview && (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm font-medium text-gray-600">This Month Expenses</p>
                <p className="text-2xl font-semibold text-gray-900">
                  ${data.overview.overview.thisMonth.totalAmount.toLocaleString()}
                </p>
                <p className="text-sm text-gray-500">
                  {data.overview.overview.thisMonth.totalCount} receipts
                </p>
                <p className="text-sm text-green-600">
                  ‚Üó {data.overview.overview.thisMonth.growth}% from last month
                </p>
              </div>
              <div className="p-3 rounded-lg bg-blue-50 text-blue-600">
                üí∞
              </div>
            </div>
          </div>

          <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm font-medium text-gray-600">Pending Receipts</p>
                <p className="text-2xl font-semibold text-gray-900">
                  {data.overview.overview.pending.receipts}
                </p>
                <p className="text-sm text-gray-500">Awaiting approval</p>
              </div>
              <div className="p-3 rounded-lg bg-yellow-50 text-yellow-600">
                ‚è∞
              </div>
            </div>
          </div>

          <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm font-medium text-gray-600">Fleet Utilization</p>
                <p className="text-2xl font-semibold text-gray-900">
                  {data.overview.overview.fleet.utilizationRate}%
                </p>
                <p className="text-sm text-gray-500">
                  {data.overview.overview.fleet.activeTrucks}/{data.overview.overview.fleet.totalTrucks} trucks active
                </p>
              </div>
              <div className="p-3 rounded-lg bg-green-50 text-green-600">
                üöõ
              </div>
            </div>
          </div>

          <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-sm font-medium text-gray-600">Active Drivers</p>
                <p className="text-2xl font-semibold text-gray-900">
                  {data.overview.overview.drivers.total}
                </p>
                <p className="text-sm text-gray-500">Total registered</p>
              </div>
              <div className="p-3 rounded-lg bg-blue-50 text-blue-600">
                üë•
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Controls */}
      <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
        <div className="flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0">
          <div className="flex items-center space-x-4">
            {/* Date Range Picker */}
            <div className="flex items-center space-x-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                <input
                  type="date"
                  value={dateRange.start}
                  onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}
                  className="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">End Date</label>
                <input
                  type="date"
                  value={dateRange.end}
                  onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}
                  className="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
              </div>
            </div>

            {/* Group By Selector */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Group By</label>
              <select
                value={groupBy}
                onChange={(e) => setGroupBy(e.target.value)}
                className="border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
              >
                <option value="category">Category</option>
                <option value="truck">Truck</option>
                <option value="driver">Driver</option>
              </select>
            </div>
          </div>

          {/* Export Buttons */}
          <div className="flex space-x-2">
            <button
              onClick={handleExportCSV}
              className="bg-green-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-green-700"
            >
              Export CSV
            </button>
            <button
              onClick={handleExportPDF}
              className="bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-red-700"
            >
              Export PDF
            </button>
          </div>
        </div>
      </div>

      {/* Summary Section */}
      {data?.summary && (
        <div className="bg-white rounded-lg p-6 shadow-sm border border-gray-200">
          <div className="flex items-center justify-between mb-6">
            <h3 className="text-lg font-semibold text-gray-900">
              Expenses Summary - {groupBy.charAt(0).toUpperCase() + groupBy.slice(1)}
            </h3>
            <div className="text-sm text-gray-600">
              Total: ${data.summary.summary.totalAmount.toLocaleString()} | 
              {data.summary.summary.totalReceipts} receipts
            </div>
          </div>

          {/* Quick Stats */}
          <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
            <div className="text-center">
              <p className="text-2xl font-bold text-green-600">{data.summary.summary.approvedReceipts}</p>
              <p className="text-sm text-gray-600">Approved</p>
            </div>
            <div className="text-center">
              <p className="text-2xl font-bold text-yellow-600">{data.summary.summary.pendingReceipts}</p>
              <p className="text-sm text-gray-600">Pending</p>
            </div>
            <div className="text-center">
              <p className="text-2xl font-bold text-red-600">{data.summary.summary.rejectedReceipts}</p>
              <p className="text-sm text-gray-600">Rejected</p>
            </div>
            <div className="text-center">
              <p className="text-2xl font-bold text-blue-600">${data.summary.summary.averageExpense}</p>
              <p className="text-sm text-gray-600">Average</p>
            </div>
            <div className="text-center">
              <p className="text-2xl font-bold text-gray-900">${data.summary.summary.totalAmount.toLocaleString()}</p>
              <p className="text-sm text-gray-600">Total</p>
            </div>
          </div>

          {/* Breakdown Table */}
          <div className="space-y-4">
            <h4 className="font-medium text-gray-900">Breakdown by {groupBy}</h4>
            <div className="space-y-3">
              {data.summary.expenses.map((item, index) => (
                <div key={index} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                  <div className="flex items-center space-x-4">
                    <div 
                      className="w-4 h-4 rounded-full" 
                      style={{ backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'][index % 5] }}
                    ></div>
                    <div>
                      <p className="font-medium text-gray-900">{item.groupBy}</p>
                      <p className="text-sm text-gray-600">{item.receiptCount} receipts</p>
                    </div>
                  </div>
                  <div className="text-right">
                    <p className="font-semibold text-gray-900">${item.totalAmount.toLocaleString()}</p>
                    <p className="text-sm text-gray-600">{item.percentage}% | Avg: ${item.averageAmount.toFixed(2)}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

      {/* Footer */}
      <div className="text-center text-gray-500 text-sm">
        Admin Dashboard ‚Ä¢ Last updated: {new Date().toLocaleString()}
      </div>
    </div>
  );
}
